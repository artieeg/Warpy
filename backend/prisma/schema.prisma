datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "linux-musl"]
}

model User {
  id          String       @id @default(cuid())
  username    String
  first_name  String
  last_name   String
  avatar      String
  email       String
  sub         String
  created_at  DateTime     @default(now())
  participant Participant?


  @@map(name: "Users")
}

model Participant {
  id            String  @id @default(cuid())
  user_id       String  @unique
  user          User    @relation(fields: [user_id], references: [id])
  stream_id     String 
  stream        Candidate  @relation(fields: [stream_id], references: [id])
  role          String
  isRaisingHand Boolean

  @@unique([user_id, stream_id], name: "stream_participant_index")
}

model Stream {
  id    String  @id @default(cuid())
  title String
  owner String
  hub   String
  live  Boolean
}

model Candidate {
  id      String @id @default(cuid())
  title   String
  owner   String @unique
  hub     String
  preview String?

  speakers Participant[]
}

model RefreshToken {
  id    String @id @default(cuid())
  token String
}
